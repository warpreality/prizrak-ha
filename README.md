# –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å–∏–≥–Ω–∞–ª–∏–∑–∞—Ü–∏–∏ –ü—Ä–∏–∑—Ä–∞–∫ –¥–ª—è Home Assistant

–ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è –¥–ª—è Home Assistant, –ø–æ–∑–≤–æ–ª—è—é—â–∞—è —É–ø—Ä–∞–≤–ª—è—Ç—å –∞–≤—Ç–æ–º–æ–±–∏–ª—å–Ω–æ–π —Å–∏–≥–Ω–∞–ª–∏–∑–∞—Ü–∏–µ–π –ü—Ä–∏–∑—Ä–∞–∫ —á–µ—Ä–µ–∑ —Å–∏—Å—Ç–µ–º—É –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞ [monitoring.tecel.ru](https://monitoring.tecel.ru/).

## –°—Ç–∞—Ç—É—Å –ø—Ä–æ–µ–∫—Ç–∞

üöß **–í –∞–∫—Ç–∏–≤–Ω–æ–π —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–µ** - –±–∞–∑–æ–≤–∞—è —Å—Ç—Ä—É–∫—Ç—É—Ä–∞ —Å–æ–∑–¥–∞–Ω–∞, –ø—Ä–æ–¥–æ–ª–∂–∞–µ—Ç—Å—è —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è API –∫–ª–∏–µ–Ω—Ç–∞

### –¢–µ–∫—É—â–∏–π –ø—Ä–æ–≥—Ä–µ—Å—Å

- ‚úÖ –ò–∑—É—á–µ–Ω–∏–µ API —Å–∏—Å—Ç–µ–º—ã –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞
- ‚úÖ –î–æ–∫—É–º–µ–Ω—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ API endpoints –∏ –º–µ—Ç–æ–¥–æ–≤ SignalR
- ‚úÖ –°–æ–∑–¥–∞–Ω–∏–µ –±–∞–∑–æ–≤–æ–π —Å—Ç—Ä—É–∫—Ç—É—Ä—ã –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏
- ‚úÖ –†–µ–∞–ª–∏–∑–∞—Ü–∏—è config_flow –¥–ª—è –Ω–∞—Å—Ç—Ä–æ–π–∫–∏
- ‚úÖ –°–æ–∑–¥–∞–Ω–∏–µ entities (sensors, switches, buttons)
- ‚è≥ –†–µ–∞–ª–∏–∑–∞—Ü–∏—è API –∫–ª–∏–µ–Ω—Ç–∞ (–∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è, SignalR)
- ‚è≥ –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏

## –í–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏

### –†–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ
- üìä Sensors –¥–ª—è –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞ —Å–æ—Å—Ç–æ—è–Ω–∏—è –∞–≤—Ç–æ–º–æ–±–∏–ª—è:
  - –°–æ—Å—Ç–æ—è–Ω–∏–µ (–æ—Ö—Ä–∞–Ω–∞, —Å–µ—Ä–≤–∏—Å–Ω—ã–π —Ä–µ–∂–∏–º –∏ —Ç.–¥.)
  - –¢–µ–º–ø–µ—Ä–∞—Ç—É—Ä–∞ (–∑–∞ –±–æ—Ä—Ç–æ–º, –¥–≤–∏–≥–∞—Ç–µ–ª—å, —Å–∞–ª–æ–Ω)
  - –ù–∞–ø—Ä—è–∂–µ–Ω–∏–µ –∞–∫–∫—É–º—É–ª—è—Ç–æ—Ä–∞
  - –û–±–æ—Ä–æ—Ç—ã –¥–≤–∏–≥–∞—Ç–µ–ª—è
  - –£—Ä–æ–≤–µ–Ω—å —Ç–æ–ø–ª–∏–≤–∞
  - –°–∫–æ—Ä–æ—Å—Ç—å
  - –ü—Ä–æ–±–µ–≥
  - –ë–∞–ª–∞–Ω—Å —Å—á–µ—Ç–∞
  - –í—Ä–µ–º—è –∞–≤—Ç–æ–∑–∞–ø—É—Å–∫–∞

- üîò Switches –¥–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è:
  - –ê–≤—Ç–æ–∑–∞–ø—É—Å–∫ (–≤–∫–ª—é—á–µ–Ω–∏–µ/–≤—ã–∫–ª—é—á–µ–Ω–∏–µ)
  - –°–µ—Ä–≤–∏—Å–Ω—ã–π —Ä–µ–∂–∏–º (—Ç—Ä–µ–±—É–µ—Ç PUK-–∫–æ–¥)

### –ü–ª–∞–Ω–∏—Ä—É–µ—Ç—Å—è
- –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –æ—Ö—Ä–∞–Ω–æ–π
- –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∫–ª–∏–º–∞—Ç-–∫–æ–Ω—Ç—Ä–æ–ª–µ–º
- –ö–Ω–æ–ø–∫–∏ –¥–ª—è –æ–¥–Ω–æ—Ä–∞–∑–æ–≤—ã—Ö –∫–æ–º–∞–Ω–¥ (–ø–æ–∏—Å–∫, —Ç—Ä–µ–≤–æ–≥–∞, –∑–∞–ø—Ä–æ—Å –º–µ—Å—Ç–æ–ø–æ–ª–æ–∂–µ–Ω–∏—è)

## –£—Å—Ç–∞–Ω–æ–≤–∫–∞

### –ß–µ—Ä–µ–∑ HACS (–ø–æ—Å–ª–µ –ø—É–±–ª–∏–∫–∞—Ü–∏–∏)

1. –î–æ–±–∞–≤—å—Ç–µ —ç—Ç–æ—Ç —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π –≤ HACS –∫–∞–∫ Custom repository
2. –£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—é —á–µ—Ä–µ–∑ HACS
3. –ü–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç–µ Home Assistant
4. –î–æ–±–∞–≤—å—Ç–µ –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—é —á–µ—Ä–µ–∑ Settings ‚Üí Devices & Services ‚Üí Add Integration

### –†—É—á–Ω–∞—è —É—Å—Ç–∞–Ω–æ–≤–∫–∞

1. –°–∫–æ–ø–∏—Ä—É–π—Ç–µ –ø–∞–ø–∫—É `custom_components/prizrak` –≤ –ø–∞–ø–∫—É `custom_components` –≤–∞—à–µ–≥–æ Home Assistant
2. –ü–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç–µ Home Assistant
3. –î–æ–±–∞–≤—å—Ç–µ –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—é —á–µ—Ä–µ–∑ Settings ‚Üí Devices & Services ‚Üí Add Integration

## –ù–∞—Å—Ç—Ä–æ–π–∫–∞

1. –ü–µ—Ä–µ–π–¥–∏—Ç–µ –≤ Settings ‚Üí Devices & Services
2. –ù–∞–∂–º–∏—Ç–µ "Add Integration" –∏ –Ω–∞–π–¥–∏—Ç–µ "–ü—Ä–∏–∑—Ä–∞–∫"
3. –í–≤–µ–¥–∏—Ç–µ –≤–∞—à–∏ —É—á–µ—Ç–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ:
   - Email (–∏—Å–ø–æ–ª—å–∑—É–µ–º—ã–π –¥–ª—è –≤—Ö–æ–¥–∞ –Ω–∞ monitoring.tecel.ru)
   - –ü–∞—Ä–æ–ª—å
4. –í—ã–±–µ—Ä–∏—Ç–µ –∞–≤—Ç–æ–º–æ–±–∏–ª—å –∏–∑ —Å–ø–∏—Å–∫–∞
5. (–û–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ) –í–≤–µ–¥–∏—Ç–µ PUK-–∫–æ–¥ –¥–ª—è –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è —Å–µ—Ä–≤–∏—Å–Ω–æ–≥–æ —Ä–µ–∂–∏–º–∞

## –¢—Ä–µ–±–æ–≤–∞–Ω–∏—è

- Home Assistant 2023.1.0 –∏–ª–∏ –Ω–æ–≤–µ–µ
- Python 3.9+
- –ê–∫–∫–∞—É–Ω—Ç –≤ —Å–∏—Å—Ç–µ–º–µ –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞ –ü—Ä–∏–∑—Ä–∞–∫ (monitoring.tecel.ru)
- PUK-–∫–æ–¥ (–¥–ª—è –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è —Å–µ—Ä–≤–∏—Å–Ω–æ–≥–æ —Ä–µ–∂–∏–º–∞)

## –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞

```
prizrak-ha/
‚îú‚îÄ‚îÄ custom_components/
‚îÇ   ‚îî‚îÄ‚îÄ prizrak/
‚îÇ       ‚îú‚îÄ‚îÄ __init__.py          # –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏
‚îÇ       ‚îú‚îÄ‚îÄ manifest.json        # –ú–µ—Ç–∞–¥–∞–Ω–Ω—ã–µ –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏
‚îÇ       ‚îú‚îÄ‚îÄ config_flow.py       # –ù–∞—Å—Ç—Ä–æ–π–∫–∞ —á–µ—Ä–µ–∑ UI
‚îÇ       ‚îú‚îÄ‚îÄ const.py             # –ö–æ–Ω—Å—Ç–∞–Ω—Ç—ã
‚îÇ       ‚îú‚îÄ‚îÄ api.py               # API –∫–ª–∏–µ–Ω—Ç
‚îÇ       ‚îú‚îÄ‚îÄ coordinator.py       # –ö–æ–æ—Ä–¥–∏–Ω–∞—Ç–æ—Ä –¥–∞–Ω–Ω—ã—Ö
‚îÇ       ‚îú‚îÄ‚îÄ sensor.py            # Sensors
‚îÇ       ‚îú‚îÄ‚îÄ switch.py            # Switches
‚îÇ       ‚îú‚îÄ‚îÄ button.py            # Buttons
‚îÇ       ‚îî‚îÄ‚îÄ strings.json         # –õ–æ–∫–∞–ª–∏–∑–∞—Ü–∏—è
‚îú‚îÄ‚îÄ API_RESEARCH.md             # –ò—Å—Å–ª–µ–¥–æ–≤–∞–Ω–∏–µ API
‚îú‚îÄ‚îÄ PLAN.md                     # –ü–ª–∞–Ω —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏
‚îî‚îÄ‚îÄ README.md                   # –≠—Ç–æ—Ç —Ñ–∞–π–ª
```

## –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è

- [–ü–ª–∞–Ω —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏](PLAN.md) - –¥–µ—Ç–∞–ª—å–Ω—ã–π –ø–ª–∞–Ω –∑–∞–¥–∞—á
- [–ò—Å—Å–ª–µ–¥–æ–≤–∞–Ω–∏–µ API](API_RESEARCH.md) - —Å–æ–±—Ä–∞–Ω–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ–± API —Å–∏—Å—Ç–µ–º—ã –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞

## –ò–∑–≤–µ—Å—Ç–Ω—ã–µ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è

- SignalR –∫–ª–∏–µ–Ω—Ç –µ—â–µ –Ω–µ –ø–æ–ª–Ω–æ—Å—Ç—å—é —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω (—Ç—Ä–µ–±—É–µ—Ç—Å—è –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–æ–µ –∏—Å—Å–ª–µ–¥–æ–≤–∞–Ω–∏–µ)
- –ê–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è –∏—Å–ø–æ–ª—å–∑—É–µ—Ç –∑–∞–≥–ª—É—à–∫–∏ (—Ç—Ä–µ–±—É–µ—Ç—Å—è —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è —Ä–µ–∞–ª—å–Ω–æ–≥–æ API)
- –ù–µ –≤—Å–µ –∫–æ–º–∞–Ω–¥—ã —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω—ã (—Ç—Ä–µ–±—É–µ—Ç—Å—è –∏–∑—É—á–µ–Ω–∏–µ –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã—Ö –º–µ—Ç–æ–¥–æ–≤ SignalR)

## –†–∞–∑—Ä–∞–±–æ—Ç–∫–∞

### –õ–æ–∫–∞–ª—å–Ω–æ–µ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

–ü–µ—Ä–µ–¥ —É—Å—Ç–∞–Ω–æ–≤–∫–æ–π –≤ Home Assistant –º–æ–∂–Ω–æ –ø—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å API –∫–ª–∏–µ–Ω—Ç –ª–æ–∫–∞–ª—å–Ω–æ:

```bash
# –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π –¥–ª—è —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏
pip install -r requirements-dev.txt

# –ó–∞–ø—É—Å–∫ unit —Ç–µ—Å—Ç–æ–≤
pytest tests/ -v

# –õ–æ–∫–∞–ª—å–Ω–æ–µ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ API (—Ç—Ä–µ–±—É–µ—Ç —Ä–µ–∞–ª—å–Ω—ã–µ —É—á–µ—Ç–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ)
python test_local.py
```

‚ö†Ô∏è **–í–Ω–∏–º–∞–Ω–∏–µ:** `test_local.py` –≤—ã–ø–æ–ª–Ω—è–µ—Ç —Ä–µ–∞–ª—å–Ω—ã–µ –∑–∞–ø—Ä–æ—Å—ã –∫ API –∏ –º–æ–∂–µ—Ç –æ—Ç–ø—Ä–∞–≤–ª—è—Ç—å –∫–æ–º–∞–Ω–¥—ã –Ω–∞ –∞–≤—Ç–æ–º–æ–±–∏–ª—å!

### –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –≤ Home Assistant

–°–º. [INSTALL_HA.md](INSTALL_HA.md) –¥–ª—è –ø–æ–¥—Ä–æ–±–Ω—ã—Ö –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏–π.

### –ó–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏

```bash
# –î–ª—è —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏
pip install -r requirements-dev.txt

# –î–ª—è –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏ (—É—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞—é—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –≤ HA)
# aiohttp>=3.8.0
# websockets>=11.0
```

### –ó–∞–ø—É—Å–∫ –ª–∏–Ω—Ç–µ—Ä–∞

```bash
# –ü—Ä–æ–≤–µ—Ä–∫–∞ –∫–æ–¥–∞
python -m pylint custom_components/prizrak/
```

## –õ–∏—Ü–µ–Ω–∑–∏—è

MIT License (–ø–ª–∞–Ω–∏—Ä—É–µ—Ç—Å—è)

## –ê–≤—Ç–æ—Ä

–†–∞–∑—Ä–∞–±–æ—Ç–∞–Ω–æ –¥–ª—è –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏ —Å–∏—Å—Ç–µ–º—ã –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞ –ü—Ä–∏–∑—Ä–∞–∫ —Å Home Assistant